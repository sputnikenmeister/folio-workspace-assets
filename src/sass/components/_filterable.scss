// -----------------------------------
// Filterable
// -----------------------------------

// Transitions
// - - - - - - - - - - - - - - - - - -
$collapse_ease: $ease;
//$collapse_ease: ease-out;

%changing-list {
	// wait, expand, fadein
	transition-property: visibility, opacity, transform;
	transition-timing-function: step-start, $collapse_ease, $collapse_ease;
	/* bundle-style */
	// transition-duration: $delay * 2 + $duration - 0.001s, $duration - 0.001s, $duration - 0.001s;
	// transition-delay: $delay * 0 + 0.001s, $delay * 2 + 0.001s, $delay * 1 + 0.001s;
	/* keyword-style */
	transition-duration: $duration - 0.001s, $duration - 0.001s, $duration - 0.001s;
	transition-delay: $delay * 2 + 0.001s, $delay * 2 + 0.001s, $delay * 1 + 0.001s;
}
%changing-list-excluded {
	// fadeout, collapse, wait
	// transition-timing-function: step-end, $collapse_ease, $collapse_ease;
	transition-timing-function: step-end, $collapse_ease, step-end;
	transition-delay: 0s + 0.001s, 0s + 0.001s, $delay * 1 + 0.001s;
}
%changing-list-shorthand {
	transition:
		visibility ($duration - 0.001s) step-start ($delay*2 + 0.001s),
		opacity ($duration - 0.001s) $collapse_ease ($delay*2 + 0.001s),
		transform ($duration - 0.001s) $collapse_ease ($delay*1 + 0.001s);
}
%changing-list-excluded-shorthand {
	transition:
		visibility ($duration*1 - 0.001s) step-end ($delay*0 + 0.001s) ,
		opacity ($duration*1 - 0.001s) $collapse_ease ($delay*0 + 0.001s),
		transform ($duration*1 - 0.001s) $collapse_ease ($delay*1 + 0.001s);
}
// &.collapsed-changed {
// 	.list-group, .list-item {
// 		transition-delay: $delay * 1 + 0.001s, $delay * 1 + 0.001s, $delay * 0 + 0.001s;
// 	}
// }
%entering-list {
	transition-duration: $duration - 0.001s, $duration - 0.001s, $duration - 0.001s;
	transition-delay: 0s + 0.001s, 0s + 0.001s, $delay * 1 + 0.001s;
}

// - - - - - - - - - - - - - - - - - -
// FilterableListView
// - - - - - - - - - - - - - - - - - -
.list {
	position: relative;
	.list-item, .list-group {
		// position: static;
		position: absolute;
		display: block;
		top: 0; left: 0;
		transform: translate3d(0,0,0);
		transform-style: preserve-3d;
	}
}

#bundle-list {
	.list-item {
		visibility: visible;
		opacity: 1;
//		max-height: 1.5em;
	}
	&.collapsed {
		.list-item {
			max-height: 0;// watch out!!!
		}
		.list-item:not(.selected) {
			visibility: hidden;
			opacity: 0;
			// max-height: 0;
		}
		// .list-item.selected {
		// 	visibility: visible;
		// 	opacity: 1;
		// 	max-height: 1.5em;
		// }
	}
}
#bundle-list {
	.list-item {
		// wait, expand, fadein
		@extend %changing-list;
	}
	&.collapsed {
		.list-item:not(.selected) {
			// fadeout, collapse, wait
			@extend %changing-list-excluded;
		}
	}
	&.collapsed-changed.collapsed {
		.list-item {
			&, &.excluded {
				@extend %entering-list;
			}
		}
	}
	&.skip-transitions {
		.list-item {
			&, * {
				@include skip_transitions;
			}
		}
	}
}

// - - - - - - - - - - - - - - - - - -
// GroupingListView
// - - - - - - - - - - - - - - - - - -
#keyword-list {
	.list-item, .list-group {
		visibility: visible;
		opacity: 1;
		height: auto;
	}
	&.collapsed {
		.list-item.excluded, .list-group.excluded {
			visibility: hidden;
			opacity: 0;
			height: 0;
		}
	}
}

#keyword-list  {
	.list-group, .list-item {
		// wait, expand, fadein
		@extend %changing-list;
	}
	&.collapsed {
		.list-group.excluded, .list-item.excluded {
			// fadeout, collapse, wait
			@extend %changing-list-excluded;
		}
	}
	&.collapsed-changed.collapsed {
		.list-group, .list-item {
			&, &.excluded {
				@extend %entering-list;
			}
		}
	}
	&.skip-transitions {
		.list-group, .list-item {
			&, * {
				@include skip_transitions;
			}
		}
	}
}
 
#keyword-list  {
	.list-item.selected {
		.name {
			text-decoration: underline;
			// background-color: transparentize($link-color, 0.5);
			// border-bottom: 1px solid currentColor;
		}
	}
}
#bundle-list.has-excluded:not(.collapsed) {
	.list-item:not(.excluded) {
		.name {
			text-decoration: underline;
			// background-color: transparentize($link-color, 0.5);
			// border-bottom: 1px solid currentColor;
		}
	}
}
