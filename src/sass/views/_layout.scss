// -----------------------------------
// Layout
// -----------------------------------

// - - - - - - - - - - - - - - - - - -
// Abstract rules
// - - - - - - - - - - - - - - - - - -

@import "../includes/_media-queries";

$header_height: 2.25rem;
$footer_height: 3rem;
$nav_height_landscape: 9rem;
$nav_height_portrait: 14.25rem;

// - - - - - - - - - - - - - - - - - -
// container elements
// - - - - - - - - - - - - - - - - - -

%page_region_left {
	left: calc(50% - #{$page_width/2});
	@include media($desktop_small) {
		left: calc(50% - #{$page_width_large/2});
	}
}
%page_region_width {
	width: $page_width;
	@include media($desktop_small) {
		width: $page_width_large;
	}
}
%page_region_maxwidth {
	max-width: $page_width;
	@include media($desktop_small) {
		max-width: $page_width_large;
	}
}
%page_region_abs {
	position: absolute;
	@extend %page_region_left;
	@extend %page_region_maxwidth;
}
%page_region_static {
	margin: 0 auto;
	@extend %page_region_maxwidth;
}

// - - - - - - - - - - - - - - - - - -
// leaf elements
// - - - - - - - - - - - - - - - - - -

%leaf-content {
	box-sizing: border-box;
	padding-left: $hu;
	padding-right: $hu;
	&, * {
		user-select: none !important;
	}
}

// - - - - - - - - - - - - - - - - - -
// container vertical movement
// - - - - - - - - - - - - - - - - - -

@mixin nav_transition($delay_count: null) {}

@mixin nav_transition_short($phase: null) {
	@if $phase == exiting {
		transition: transform #{$duration - 0.001s} $ease 0.001s;
	} @else if $phase == changing {
		transition: transform #{$duration - 0.001s} $ease #{$delay*1 + 0.001s};
	} @else if $phase == entering {
		transition: transform #{$duration - 0.001s} $ease #{$delay*2 + 0.001s};
	} @else if $phase == skip {
		transition: none 0s 0s;
	} @else {
		transition: transform $duration $ease 0s;
	}
}

@mixin nav_transition_long($delay_count: null) {
	@if $delay_count == -1 {
		transition-property: none;
		transition-duration: 0s;
		transition-delay: 0s;
	} @else if $delay_count {
		transition-property: transform;
		transition-timing-function: $ease;
		transition-duration: #{$duration - 0.001s};
		transition-delay: #{$delay * $delay_count + 0.001s};
	} @else {
		transition-property: transform;
		transition-timing-function: $ease;
		transition-duration: $duration;
		transition-delay: 0s;
	}
}

@mixin nav_translate($x, $y) {
	transform: translate3d($x, $y, 0);
	// transform: translate3d($x, $y, 0) scale3d(1,1,1);
}

// - - - - - - - - - - - - - - - - - -
// nav_list: vertical
// - - - - - - - - - - - - - - - - - -

%nav_list {
	position: absolute;
	display: inline-block;
	transform-style: preserve-3d;
	@include nav_transition(changing);
	@include nav_translate(0, #{$nav_height_portrait - 4.5rem});
}
.with-bundle %nav_list {
	@include nav_translate(0, 0);
}
.skip-transitions {
	&, &.with-bundle {
		%nav_list {
			@include skip_transitions();
		}
	}
}
@include media($desktop_small) {
	%nav_list {
		@include nav_translate(0, #{$nav_height_landscape - 1.5rem});
	}
	.with-bundle %nav_list {
		@include nav_translate(0, 0);
	}
}

// - - - - - - - - - - - - - - - - - -
// transform-wrapper: horizontal
// - - - - - - - - - - - - - - - - - -

.transform-wrapper {
	position: absolute;
	// display: inline-block;
	// transform-style: preserve-3d;
	// @include nav_translate(0, 0);
	// @include nav_transition(skip);
}
@include media($desktop_small) {
	.transform-wrapper {
		transform-style: preserve-3d;
		@include nav_translate(0, 0);
		@include nav_transition();
	}
	.entering-bundle .transform-wrapper {
		@include nav_transition(changing);
	}
	.skip-transitions .transform-wrapper {
		@include nav_transition(skip);
	}
}

// -----------------------------------
// Root container
// -----------------------------------

html, body {
	height: 100%;
}
#container {
	width: 100%;
	height: 100%;
	display: block;
	overflow: hidden;
	min-width: $page_width;
	@include media($desktop_small) {
		min-width: $page_width_large;
	}
}

// - - - - - - - - - - - - - - - - - -
// navigation
// - - - - - - - - - - - - - - - - - -

#navigation {
	@extend %page_region_static;
	position: relative;
	top: $header_height;
}
@import "_navigation";

// - - - - - - - - - - - - - - - - - -
// content
// - - - - - - - - - - - - - - - - - -

#content {
	overflow: hidden;
	position: absolute;
	// position: relative;
	// box-sizing: content-box;
	box-sizing: border-box;
	width: 100%;
	top: 0;
	padding-top: $nav_height_portrait + $header_height;
	// padding-bottom: $footer_height;
	height: 100%;
	// height: calc(100% - #{$footer_height});
	// height: calc(100% - #{$nav_height_portrait + $header_height + $footer_height});
	@include media($desktop_small) {
		padding-top: $nav_height_landscape + $header_height;
		// padding-bottom: $footer_height;
		// height: calc(100% - #{$nav_height_landscape + $header_height + $footer_height});
	}
}
@import "_content";

// - - - - - - - - - - - - - - - - - -
// footer
// - - - - - - - - - - - - - - - - - -

//@import "views/_footer";

// ------------------------------------
// Body init
// ------------------------------------

.app-ready #container {
	transition:
		visibility $duration $delay step-start,
		opacity $duration $delay $ease;
	visibility: visible;
	opacity: 1;
}

.app-initial #container {
	visibility: hidden;
	opacity: 0;
}

.app-initial *, body.skip-transitions * {
	@include skip_transitions;
}

// ------------------------------------
// Dynamic color
// ------------------------------------
// body default color values specified in "_base.scss"

.mutable-faded {
	color: lighten($color, 40%);
	border-color: lighten($color, 60%);
}

body, .mutable-faded {
	transition:
	//	border-color $duration $ease $delay*2,
		background-color $duration $ease $delay*2,
		color $duration $ease $delay*2;
	// transition-timing-function: $ease;
	// transition-property: color, border-color, background-color;
	// transition-duration: $duration;
	// transition-delay: $delay * 2;
}

// -----------------------------------
// Layer ordering
// -----------------------------------
//		#site-name-wrapper, #bundle-list-wrapper, #keyword-list-wrapper
//		#bundle-pager {}

#container {
	z-index: 1;
	#navigation {
		// z-index: 1;
		@at-root .transform-wrapper {
			z-index: 1;
			.list {
				z-index: 1;
				// .list-item, .group-item {
				// 	z-index: 2;
				// }
			}
		}
	}
	#content {
		// z-index: 1;
		@at-root .image-carousel {
			z-index: 0;
			&.scrolling, &.panning {
				z-index: 2;
			}
			// .carousel-item {
			// 	.placeholder, .content {
			// 		z-index: 3;
			// 	}
			// }
		}
	}
}
//@import "views/_transitions";
